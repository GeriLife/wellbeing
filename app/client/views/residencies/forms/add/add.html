<template name="addResidencyModal">
  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">
            {{_ "addResidencyModal-header" }}
          </h4>
        </div> <!-- / .modal-header -->
        {{# if Template.subscriptionsReady }}
        <div class="modal-body">
          <!-- new resident radio (checked by default) -->
          <div class="radio">
            <label>
              <input type="radio" name="new-or-existing" value="new" checked>
              {{_ "addResidencyForm-newOrExisting-new" }}
            </label>
          </div>

          <!-- existing resident radio (unchecked by default) -->
          <div class="radio">
            <label>
              <input type="radio" name="new-or-existing" value="existing">
              {{_ "addResidencyForm-newOrExisting-existing" }}
            </label>
          </div>

          {{# if addingResidencyForExistingResident }}
            {{> addResidencyForExistingResidentForm }}
          {{ else }}
          <!-- adding new resident and residency -->
            {{#autoForm
              schema=newResidentAndResidencySchema
              id="addNewResidentAndResidency"
              type="method"
              meteormethod="addNewResidentAndResidency" }}

              <label for="firstName">
                {{_ "residents.firstName.label" }}
              </label>
              {{> afFieldInput name="firstName"}}

              <label for="lastInitial">
                {{_ "residents.lastInitial.label" }}
              </label>
              {{> afFieldInput name="lastInitial"}}

              <label for="homeId">
                {{_ "residencies.homeId.label" }}
              </label>
              {{> afFieldInput name="homeId" options=homeSelectOptionsWithGroups }}

              <label for="moveIn">
                {{_ "residencies.moveIn.label" }}
              </label>
              {{> afFieldInput name="moveIn" buttonClasses="fa fa-calendar" value=today }}

              <button type="submit" class="btn btn-success">
                {{_ "addResidencyForm-save" }}
              </button>
              <button type="button" class="btn btn-danger" data-dismiss="modal">
                {{_ "addResidencyForm-cancel" }}
              </button>
            {{/ autoForm }}
          {{/ if }}
        </div> <!-- / .modal-body -->
        {{ else }}
          {{> spinner }}
        {{/ if }} <!-- /if Template.subscriptionsReady -->
      </div> <!-- / .modal-content -->
    </div> <!-- / .modal-dialogue -->
  </div> <!-- / .modal fade -->
</template>
